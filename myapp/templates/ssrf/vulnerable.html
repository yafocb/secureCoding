<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Vulnerable SSRF Result</title>
    <style>
        /* 이미지가 너무 커지는 것을 방지하기 위한 스타일 */
        img {
            max-width: 100%;
            height: auto;
            border: 1px solid #ccc;
            display: block;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>SSRF 취약점 테스트 결과 (Vulnerable)</h1>
    
    {% if is_image %}
        <h2>🖼️ 이미지 로드 성공</h2>
        <p>서버가 요청한 이미지를 가져와 Base64로 인코딩하여 표시합니다.</p>
        <img src="{{ result_data }}" alt="요청된 이미지">
    {% else %}
        <h2>⚠️ 외부/내부 서버 응답 내용 (SSRF 시연)</h2>
        <p>요청한 URL의 응답 텍스트/HTML 내용입니다. 내부 서버 주소를 입력하면 이 곳에 내부 정보가 노출됩니다.</p>
        <pre>{{ result_data }}</pre> 
    {% endif %}
    
    <hr>
    <a href="{% url 'image_form' %}">다시 폼으로 돌아가기</a>
</body>
</html>