<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>í…ŒìŠ¤íŠ¸ ê²°ê³¼</title>
  {% load static %}
  <link rel="stylesheet" href="{% static 'css/common.css' %}">
  <style>
    body {
      background: linear-gradient(135deg, #bfe9ff 0%, #ff6e7f 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 900px;
    }

    h1 {
      border-bottom: 3px solid #667eea;
      color: #333;
    }

    .mode-badge {
      display: inline-block;
      padding: 10px 20px;
      border-radius: 25px;
      font-weight: bold;
      font-size: 1.1em;
      margin: 15px 0;
      color: #fff;
    }

    .badge-vuln {
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
    }

    .badge-safe {
      background: linear-gradient(135deg, #2196F3 0%, #21CBF3 100%);
    }

    .result-box {
      background: white;
      padding: 25px;
      border-radius: 15px;
      margin: 20px 0;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    .result-box h3 {
      color: #555;
      margin-top: 0;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #f0f0f0;
    }

    .sql-query {
      background: #f4f4f4;
      padding: 15px;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      color: #333;
      overflow-x: auto;
      border-left: 4px solid #667eea;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .data-list {
      list-style: none;
      padding: 0;
    }

    .data-list li {
      background: #f8f9fa;
      padding: 12px 15px;
      margin: 8px 0;
      border-radius: 8px;
      border-left: 3px solid #667eea;
    }

    .attack-success {
      background: #fff5f5;
      border-left-color: #ff6b6b;
      color: #c62828;
      font-weight: bold;
    }

    .safe-success {
      background: #f5fff5;
      border-left-color: #56ab2f;
      color: #2e7d32;
      font-weight: bold;
    }

    .blocked {
      background: #fff3e0;
      border-left-color: #ff9800;
      color: #e65100;
      font-weight: bold;
    }

    .message-box {
      padding: 15px;
      border-radius: 10px;
      margin: 20px 0;
      border-left: 4px solid;
      font-weight: bold;
    }

    .message-attack {
      background: #fff5f5;
      border-color: #ff6b6b;
      color: #c62828;
    }

    .message-safe {
      background: #f5fff5;
      border-color: #56ab2f;
      color: #2e7d32;
    }

    .message-blocked {
      background: #fff3e0;
      border-color: #ff9800;
      color: #e65100;
    }

    .no-data {
      color: #999;
      text-align: center;
      padding: 20px;
      font-style: italic;
    }

    .links {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 2px solid #e0e0e0;
      text-align: center;
    }

    .links a {
      display: inline-block;
      margin: 10px;
      padding: 12px 30px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      text-decoration: none;
      border-radius: 25px;
      font-weight: bold;
      transition: all 0.3s;
    }

    .links a:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .error-detail {
      background: #f8f9fa;
      padding: 10px;
      border-radius: 5px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      color: #666;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ” í…ŒìŠ¤íŠ¸ ê²°ê³¼</h1>

    <div>
      <strong>ì‹¤í–‰ ëª¨ë“œ:</strong>
      {% if mode == "vulnerable" %}
        <span class="mode-badge badge-vuln">
          ğŸ”´ ì·¨ì•½í•œ ì½”ë“œ (ë³´ì•ˆ ê²€ì¦ ë¯¸í¡)
        </span>
      {% elif mode == "safe" %}
        <span class="mode-badge badge-safe">
          ğŸ”µ ì•ˆì „í•œ ì½”ë“œ (ë³´ì•ˆ ê²€ì¦ ì ìš©)
        </span>
      {% else %}
        <span class="mode-badge" style="background:#6c757d;">
          â“ ì•Œ ìˆ˜ ì—†ìŒ
        </span>
      {% endif %}
    </div>

    <div class="result-box">
      <h3>ğŸ“ ì‹¤í–‰ëœ ì¿¼ë¦¬/ëª…ë ¹</h3>
      <div class="sql-query">
        {{ executed_sql }}
      </div>
    </div>

    <div class="result-box">
      <h3>ğŸ“Š ì‹¤í–‰ ê²°ê³¼</h3>

      {% if message %}
        {% if mode == "vulnerable" and attack_success %}
          <div class="message-box message-attack">
            <strong>ğŸ”´ {{ message }}</strong>
          </div>
        {% elif mode == "safe" and not attack_success %}
          <div class="message-box message-safe">
            <strong>âœ… {{ message }}</strong>
          </div>
        {% else %}
          <div class="message-box message-blocked">
            <strong>ğŸ›¡ï¸ {{ message }}</strong>
          </div>
        {% endif %}
      {% endif %}

      {% if results %}
        <ul class="data-list">
          {% for r in results %}
            {% if forloop.first %}
              {% if mode == "vulnerable" and attack_success %}
                <li class="attack-success">{{ r }}</li>
              {% elif mode == "safe" and not attack_success %}
                <li class="safe-success">{{ r }}</li>
              {% else %}
                <li class="blocked">{{ r }}</li>
              {% endif %}
            {% else %}
              <li>{{ r }}</li>
            {% endif %}
          {% endfor %}
        </ul>
      {% else %}
        {% if not message %}
          <div class="no-data">ê²°ê³¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
        {% endif %}
      {% endif %}

      {% if error_detail %}
        <div class="error-detail">
          <strong>ğŸ” ë””ë²„ê·¸ ì •ë³´:</strong><br>
          {{ error_detail }}
        </div>
      {% endif %}
    </div>

    <div class="links">
      <a href="{% url 'file_upload' %}">ğŸ”™ íŒŒì¼ ì—…ë¡œë“œë¡œ</a>
      <a href="{% url 'index' %}">ğŸ  ë©”ì¸ìœ¼ë¡œ</a>
    </div>
  </div>
</body>
</html>
